<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <title>Escolha seu Plano - Innovation.ia</title>
    <link rel="stylesheet" href="../css/futuristic-theme.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Mercado Pago SDK -->
    <script src="https://sdk.mercadopago.com/js/v2"></script>
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body class="bg-gray-950 text-white font-sans">

    <div class="relative min-h-screen">
        <!-- Background Grid handled by CSS -->

        <div class="max-w-7xl mx-auto py-12 px-4 relative z-10">
            <div class="text-center mb-16">
                <a href="/" class="inline-block logo-futuristic mb-8">INNOVATION.IA</a>
                <h1 class="text-5xl font-bold mb-6">Escolha seu Plano</h1>
                <p class="text-xl text-gray-400">Desbloqueie todo o potencial da inteligência artificial</p>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <!-- Starter -->
                <div class="glass-panel p-8">
                    <h2 class="text-2xl font-bold mb-4 text-white">Starter</h2>
                    <p class="text-4xl font-bold mb-6 text-primary-light">R$ 49<span
                            class="text-lg text-gray-400">/mês</span></p>
                    <ul class="space-y-3 mb-8 text-gray-300">
                        <li>✅ 5 vagas ativas</li>
                        <li>✅ 50 candidaturas/mês</li>
                        <li>✅ Suporte email</li>
                    </ul>
                    <button onclick="subscribe('starter')" class="btn-secondary w-full">
                        Assinar Agora
                    </button>
                </div>

                <!-- Pro -->
                <div class="glass-panel p-8 border-2 border-primary transform scale-105 shadow-xl">
                    <div
                        class="absolute -top-3 right-8 bg-primary text-white px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">
                        Mais Popular
                    </div>
                    <h2 class="text-2xl font-bold mb-4 text-white">Pro</h2>
                    <p
                        class="text-4xl font-bold mb-6 text-transparent bg-clip-text bg-gradient-to-r from-primary-light to-secondary">
                        R$ 99<span class="text-lg text-gray-400">/mês</span></p>
                    <ul class="space-y-3 mb-8 text-gray-300">
                        <li>✅ 20 vagas ativas</li>
                        <li>✅ Candidaturas ilimitadas</li>
                        <li>✅ IA Gemini Pro</li>
                        <li>✅ Chat Claude</li>
                        <li>✅ Suporte prioritário</li>
                    </ul>
                    <button onclick="subscribe('pro')" class="btn-futuristic w-full">
                        Assinar Agora
                    </button>
                </div>

                <!-- Enterprise -->
                <div class="glass-panel p-8">
                    <h2 class="text-2xl font-bold mb-4 text-white">Enterprise</h2>
                    <p class="text-4xl font-bold mb-6 text-white">R$ 299<span class="text-lg text-gray-400">/mês</span>
                    </p>
                    <ul class="space-y-3 mb-8 text-gray-300">
                        <li>✅ Vagas ilimitadas</li>
                        <li>✅ White label</li>
                        <li>✅ API dedicada</li>
                        <li>✅ Suporte 24/7</li>
                        <li>✅ Onboarding personalizado</li>
                    </ul>
                    <button onclick="subscribe('enterprise')" class="btn-secondary w-full">
                        Falar com Vendas
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Inicializar Mercado Pago
        // const mp = new MercadoPago('PUBLIC_KEY', { locale: 'pt-BR' });

        async function subscribe(plan) {
            const userId = localStorage.getItem('user_id') || 1; // Fallback to 1 for validation demo

            try {
                const response = await fetch('/api/payments/create-subscription', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${localStorage.getItem('token')}`
                    },
                    body: JSON.stringify({ plan: plan, user_id: userId })
                });

                const data = await response.json();

                if (data.checkout_url) {
                    window.location.href = data.checkout_url;
                } else {
                    alert('Erro ao criar assinatura: ' + (data.detail || 'Erro desconhecido'));
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao conectar com o servidor.');
            }
        }

        // Verificar se há parâmetro 'plan' na URL para auto-seleção
        const urlParams = new URLSearchParams(window.location.search);
        const planParam = urlParams.get('plan');
        if (planParam) {
            // Optional: Highlight selected plan or auto-scroll
            console.log("Selected plan:", planParam);
        }
    </script>
</body>

</html>